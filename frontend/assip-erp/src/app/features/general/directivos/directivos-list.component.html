<div class="card">
  <!-- Cabecera (título + acciones a la derecha) -->
  <div class="card-header">
    <h2>Directivos y organos de control</h2>
    <div class="actions">
      <a class="btn--new" [routerLink]="['/general/directivos/new']">Nuevo</a>
      <button class="btn--print" (click)="imprimir()" [disabled]="loading()">Imprimir</button>
      <app-directivos-export-button [q]="q()"></app-directivos-export-button>
    </div>
  </div>

  <div class="card-body">
    <!-- Toolbar (filtro + buscar) -->
    <div class="toolbar">
      <input
        [ngModel]="q()"
        (ngModelChange)="q.set($event)"
        [ngModelOptions]="{ standalone: true }"
        type="text"
        placeholder="Buscar por documento o nombre…"
        (keyup.enter)="buscar()"
      />
      <button class="btn" (click)="buscar()" [disabled]="loading()">Buscar</button>
    </div>

    <table class="table">
      <thead>
      <tr>
        <th>Documento</th>
        <th>Nombre</th>
        <th>Tipo</th>
        <th>Calidad</th>
        <th>Estado</th>
        <th>F. Resolución</th>
        <th>F. Retiro</th>
        <th class="num">Períodos</th>
        <th class="th-acciones">Acciones</th>
      </tr>
      </thead>
      <tbody>
      <tr *ngIf="loading()">
        <td colspan="9" class="empty">Cargando…</td>
      </tr>
      <tr *ngIf="!loading() && !data().length && !error()">
        <td colspan="9" class="empty">No hay datos</td>
      </tr>
      <tr *ngIf="error()">
        <td colspan="9" class="empty">{{ error() }}</td>
      </tr>

      <tr *ngFor="let r of data()">
        <td>{{ r.documento }}</td>
        <td>{{ r.nombrePersona }}</td>
        <td>{{ r.codigoTipoDirectivo }} — {{ nomTipo(r.codigoTipoDirectivo) }}</td>
        <td>{{ nomCalidad(r.calidadDirectivo) }}</td>
        <td>{{ nomEstado(r.estadoDirectivo) }}</td>
        <td>{{ fmtDate(r.fechaResolucion) }}</td>
        <td>{{ fmtDate(r.fechaRetiro) }}</td>
        <td class="num">{{ r.periodosVigencia ?? 0 }}</td>
        <td class="acciones">
          <button class="btn sm success" (click)="editar(r.idDirectivo)">Editar</button>
          <button class="btn sm danger" (click)="eliminar(r.idDirectivo)" [disabled]="loading()">Eliminar</button>
        </td>
      </tr>
      </tbody>
    </table>
  </div>
</div>
