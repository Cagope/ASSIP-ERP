<!-- Asegura ocultar .no-print en impresión, incluso si el SCSS del componente no aplica -->
<style>
  @media print { .no-print { display: none !important; } }
</style>

<div class="print-container">
  <div class="print-actions no-print">
    <a class="btn" [routerLink]="['/hoja-vida/financieros']">Regresar</a>
    <button class="btn btn--print" (click)="imprimir()">Imprimir</button>
  </div>

  <header class="print-header">
    <img class="logo" [src]="logoUrl()" alt="Logo empresa" />
    <div class="titles">
      <div class="empresa-sigla" *ngIf="empresaSigla()">{{ empresaSigla() }}</div>
      <div class="empresa-nit" *ngIf="empresaNit()">NIT: {{ empresaNit() }}</div>
      <h1>Datos financieros (cortes por persona)</h1>
      <div class="meta">
        <span class="date">{{ nowStr() }}</span>
      </div>
    </div>
  </header>

  <!-- Línea debajo del título -->
  <hr class="hr-print" />

  <!-- Estado global -->
  <div *ngIf="loading()" class="loading">Cargando…</div>
  <div *ngIf="!loading() && bloques().length === 0" class="empty-global">
    No hay personas con datos financieros vinculados.
  </div>

  <!-- Bloques por persona -->
  <section *ngFor="let b of bloques()" class="person-block">
    <div class="cut-label">Encabezado del corte:</div>
    <div class="person-header">
      <div class="person-name">{{ personaNombre(b.persona) }}</div>
      <div class="person-doc">{{ personaDocumento(b.persona) }}</div>
    </div>

    <div class="cut-label">Cuerpo del corte:</div>

    <!-- INGRESOS -->
    <table class="print-table" aria-label="Ingresos">
      <thead>
      <tr>
        <th style="width:160px;">Concepto</th>
        <th>Valor</th>
        <th style="width:240px;">Comentario / Origen</th>
      </tr>
      </thead>
      <tbody>
      <tr>
        <td>Valor salario</td>
        <td class="code">{{ money(b.financiero.valor_salario) }}</td>
        <td></td>
      </tr>
      <tr>
        <td>Valor pensión</td>
        <td class="code">{{ money(b.financiero.valor_pension) }}</td>
        <td></td>
      </tr>
      <tr>
        <td>Ingresos arriendo</td>
        <td class="code">{{ money(b.financiero.ingresos_arriendo) }}</td>
        <td></td>
      </tr>
      <tr>
        <td>Ingresos comisiones</td>
        <td class="code">{{ money(b.financiero.ingresos_comisiones) }}</td>
        <td></td>
      </tr>
      <tr>
        <td>Otros ingresos</td>
        <td class="code">{{ money(b.financiero.otros_ingresos) }}</td>
        <td>{{ nz(b.financiero.comentario_otros_ingresos) }}</td>
      </tr>
      <tr>
        <td>Origen de fondos</td>
        <td></td>
        <td>{{ nz(b.financiero.origen_fondos) }}</td>
      </tr>
      <tr>
        <td><b>Total ingresos</b></td>
        <td class="code"><b>{{ money(totalIngresos(b.financiero)) }}</b></td>
        <td></td>
      </tr>
      </tbody>
    </table>

    <!-- EGRESOS -->
    <table class="print-table" style="margin-top:6px;" aria-label="Egresos">
      <thead>
      <tr>
        <th style="width:160px;">Concepto</th>
        <th>Valor</th>
        <th style="width:240px;">Relación / Comentario</th>
      </tr>
      </thead>
      <tbody>
      <tr>
        <td>Egresos familiares</td>
        <td class="code">{{ money(b.financiero.egresos_familiares) }}</td>
        <td></td>
      </tr>
      <tr>
        <td>Egresos arriendo</td>
        <td class="code">{{ money(b.financiero.egresos_arriendo) }}</td>
        <td></td>
      </tr>
      <tr>
        <td>Egresos crédito</td>
        <td class="code">{{ money(b.financiero.egresos_credito) }}</td>
        <td>Relación: {{ nz(b.financiero.relacion_financiera) }}</td>
      </tr>
      <tr>
        <td>Otros egresos</td>
        <td class="code">{{ money(b.financiero.otros_egresos) }}</td>
        <td>{{ nz(b.financiero.comentario_otros_egresos) }}</td>
      </tr>
      <tr>
        <td><b>Total egresos (sin deuda)</b></td>
        <td class="code"><b>{{ money(totalEgresosSinDeuda(b.financiero)) }}</b></td>
        <td></td>
      </tr>
      <tr>
        <td>Deuda relación financiera</td>
        <td class="code">{{ money(b.financiero.deuda_relacion_financiera) }}</td>
        <td></td>
      </tr>
      </tbody>
    </table>

    <!-- PATRIMONIO -->
    <table class="print-table" style="margin-top:6px;" aria-label="Patrimonio">
      <thead>
      <tr>
        <th style="width:160px;">Concepto</th>
        <th>Valor</th>
        <th></th>
      </tr>
      </thead>
      <tbody>
      <tr>
        <td>Total activos</td>
        <td class="code">{{ money(b.financiero.total_activos) }}</td>
        <td></td>
      </tr>
      <tr>
        <td>Total pasivos</td>
        <td class="code">{{ money(b.financiero.total_pasivos) }}</td>
        <td></td>
      </tr>
      <tr>
        <td><b>Total patrimonio</b></td>
        <td class="code"><b>{{ money(totalPatrimonio(b.financiero)) }}</b></td>
        <td></td>
      </tr>
      </tbody>
    </table>

    <!-- Separador entre cortes -->
    <hr class="section-hr" />
  </section>
</div>

<!-- Pie de página (n/m) -->
<div id="pageFooter" class="page-footer no-screen">
  <span class="page-text"></span>
</div>
