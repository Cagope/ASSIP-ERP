<section class="card">
  <div class="toolbar">
    <h1>Usuarios</h1>
    <div class="actions">
      <input
        class="input"
        type="text"
        placeholder="Buscar por username..."
        [(ngModel)]="qStr"
        (keyup.enter)="onBuscar()"
      />
      <button class="btn btn--primary" (click)="onBuscar()">Buscar</button>
      <button class="btn--new">Nuevo usuario</button>
    </div>
  </div>

  <div *ngIf="cargando()">Cargando...</div>
  <div *ngIf="!cargando() && error()" class="error">{{ error() }}</div>

  <div *ngIf="!cargando() && !error()">
    <table class="table">
      <thead>
      <tr>
        <th (click)="onOrdenUsername()" class="th-sort">
          Username
          <span class="muted">({{ sort() }})</span>
        </th>
        <th>Superuser</th>
        <th>Activo</th>
        <th>Último login</th>
      </tr>
      </thead>
      <tbody>
      <tr *ngFor="let u of data()">
        <td>{{ u.username }}</td>
        <td>{{ u.superuserSeguridad ? 'Sí' : 'No' }}</td>
        <td>{{ u.activo ? 'Sí' : 'No' }}</td>
        <td>{{ u.ultimoLoginEn || '—' }}</td>
      </tr>
      <tr *ngIf="data().length === 0">
        <td colspan="4" class="muted">Sin resultados</td>
      </tr>
      </tbody>
    </table>

    <div class="pager">
      <button class="btn btn--ghost" (click)="prevPage()">Anterior</button>
      <span>Página {{ page() + 1 }} · Total {{ totalElements() }}</span>
      <button class="btn btn--ghost" (click)="nextPage()">Siguiente</button>
    </div>
  </div>
</section>
